% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\title{hw3\_fissel}
\author{Morgan Fissel}
\date{2/9/2022}

\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  pdftitle={hw3\_fissel},
  pdfauthor={Morgan Fissel},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi

\begin{document}
\maketitle

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# load melanoma tumor thickness dataset}
\FunctionTok{library}\NormalTok{(boot); }\FunctionTok{data}\NormalTok{(melanoma); y }\OtherTok{=} \FunctionTok{log}\NormalTok{(melanoma}\SpecialCharTok{$}\NormalTok{thickness)}
\end{Highlighting}
\end{Shaded}

Helper Functions

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\#AJW\#\# just moved this up so it is in memory before we use dlogisIII}
\NormalTok{dlogisIII}\OtherTok{=}\ControlFlowTok{function}\NormalTok{(x,}\AttributeTok{location=}\DecValTok{0}\NormalTok{,}\AttributeTok{scale=}\DecValTok{1}\NormalTok{,}\AttributeTok{shape=}\DecValTok{1}\NormalTok{,}\AttributeTok{log=}\ConstantTok{FALSE}\NormalTok{)\{}
\NormalTok{  x }\OtherTok{=}\NormalTok{ (x}\SpecialCharTok{{-}}\NormalTok{location)}\SpecialCharTok{/}\NormalTok{scale}
\NormalTok{  log\_y }\OtherTok{=} \FunctionTok{ifelse}\NormalTok{(x}\SpecialCharTok{\textless{}}\DecValTok{0}\NormalTok{,x}\SpecialCharTok{{-}}\FunctionTok{log}\NormalTok{(}\DecValTok{1}\SpecialCharTok{+}\FunctionTok{exp}\NormalTok{(x)),}\SpecialCharTok{{-}}\FunctionTok{log}\NormalTok{(}\DecValTok{1}\SpecialCharTok{+}\FunctionTok{exp}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{x)))}
\NormalTok{  log\_1my }\OtherTok{=} \FunctionTok{ifelse}\NormalTok{(x}\SpecialCharTok{\textless{}}\DecValTok{0}\NormalTok{,}\SpecialCharTok{{-}}\FunctionTok{log}\NormalTok{(}\DecValTok{1}\SpecialCharTok{+}\FunctionTok{exp}\NormalTok{(x)),}\SpecialCharTok{{-}}\NormalTok{x}\SpecialCharTok{{-}}\FunctionTok{log}\NormalTok{(}\DecValTok{1}\SpecialCharTok{+}\FunctionTok{exp}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{x)))}
\NormalTok{  out }\OtherTok{=} \SpecialCharTok{{-}}\FunctionTok{log}\NormalTok{(scale)}\SpecialCharTok{{-}}\FunctionTok{lbeta}\NormalTok{(shape,shape) }\SpecialCharTok{+}\NormalTok{ (shape)}\SpecialCharTok{*}\NormalTok{(log\_y}\SpecialCharTok{+}\NormalTok{log\_1my)}
  \ControlFlowTok{if}\NormalTok{(log)\{}\FunctionTok{return}\NormalTok{(out)\}}\ControlFlowTok{else}\NormalTok{\{}\FunctionTok{return}\NormalTok{(}\FunctionTok{exp}\NormalTok{(out))\}}
\NormalTok{\}}
\NormalTok{plogisIII}\OtherTok{=}\ControlFlowTok{function}\NormalTok{(q,}\AttributeTok{location=}\DecValTok{0}\NormalTok{,}\AttributeTok{scale=}\DecValTok{1}\NormalTok{,}\AttributeTok{shape=}\DecValTok{1}\NormalTok{,}\AttributeTok{lower.tail=}\ConstantTok{TRUE}\NormalTok{,}\AttributeTok{log.p=}\ConstantTok{FALSE}\NormalTok{)\{}
\NormalTok{  q }\OtherTok{=}\NormalTok{ (q}\SpecialCharTok{{-}}\NormalTok{location)}\SpecialCharTok{/}\NormalTok{scale}
\NormalTok{  Q }\OtherTok{=} \FunctionTok{ifelse}\NormalTok{(q}\SpecialCharTok{\textless{}}\DecValTok{0}\NormalTok{,}\FunctionTok{exp}\NormalTok{(q)}\SpecialCharTok{/}\NormalTok{(}\DecValTok{1}\SpecialCharTok{+}\FunctionTok{exp}\NormalTok{(q)),}\DecValTok{1}\SpecialCharTok{/}\NormalTok{(}\DecValTok{1}\SpecialCharTok{+}\FunctionTok{exp}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{q)))}
  \FunctionTok{return}\NormalTok{(}\FunctionTok{pbeta}\NormalTok{(Q,shape,shape,}\DecValTok{0}\NormalTok{,lower.tail,log.p))}
\NormalTok{\}}
\NormalTok{qlogisIII}\OtherTok{=}\ControlFlowTok{function}\NormalTok{(p,}\AttributeTok{location=}\DecValTok{0}\NormalTok{,}\AttributeTok{scale=}\DecValTok{1}\NormalTok{,}\AttributeTok{shape=}\DecValTok{1}\NormalTok{,}\AttributeTok{lower.tail=}\ConstantTok{TRUE}\NormalTok{,}\AttributeTok{log.p=}\ConstantTok{FALSE}\NormalTok{)\{}
\NormalTok{  Q }\OtherTok{=} \FunctionTok{qbeta}\NormalTok{(p,shape,shape,}\DecValTok{0}\NormalTok{,lower.tail,log.p)}
\NormalTok{  q }\OtherTok{=} \FunctionTok{ifelse}\NormalTok{(Q}\SpecialCharTok{\textless{}}\FloatTok{0.5}\NormalTok{,}\FunctionTok{log}\NormalTok{(Q)}\SpecialCharTok{{-}}\FunctionTok{log}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{Q),}\SpecialCharTok{{-}}\FunctionTok{log}\NormalTok{(}\DecValTok{1}\SpecialCharTok{/}\NormalTok{Q}\DecValTok{{-}1}\NormalTok{))}
  \FunctionTok{return}\NormalTok{(q}\SpecialCharTok{*}\NormalTok{scale}\SpecialCharTok{+}\NormalTok{location)}
\NormalTok{\}}
\NormalTok{rlogisIII}\OtherTok{=}\ControlFlowTok{function}\NormalTok{(n,}\AttributeTok{location=}\DecValTok{0}\NormalTok{,}\AttributeTok{scale=}\DecValTok{1}\NormalTok{,}\AttributeTok{shape=}\DecValTok{1}\NormalTok{)\{}
\NormalTok{  b }\OtherTok{=} \FunctionTok{rbeta}\NormalTok{(n,shape,shape,}\DecValTok{0}\NormalTok{)}
\NormalTok{  x }\OtherTok{=} \FunctionTok{ifelse}\NormalTok{(b}\SpecialCharTok{\textless{}}\FloatTok{0.5}\NormalTok{,}\FunctionTok{log}\NormalTok{(b)}\SpecialCharTok{{-}}\FunctionTok{log}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{b),}\SpecialCharTok{{-}}\FunctionTok{log}\NormalTok{(}\DecValTok{1}\SpecialCharTok{/}\NormalTok{b}\DecValTok{{-}1}\NormalTok{))}
  \FunctionTok{return}\NormalTok{(x}\SpecialCharTok{*}\NormalTok{scale}\SpecialCharTok{+}\NormalTok{location)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{enumerate}
\def\labelenumi{\alph{enumi})}
\tightlist
\item
  Write MLE Function like from likelihoods.pdf. Will use to Compute MLE
  for Type III Logisitic model. Note: scaling delta and shape alpha are
  positive.
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mle\_logisIII }\OtherTok{=} \ControlFlowTok{function}\NormalTok{(y)\{}
  \CommentTok{\#function to optimize using optim}
\NormalTok{  f }\OtherTok{=} \ControlFlowTok{function}\NormalTok{(theta)\{}
\NormalTok{    mu }\OtherTok{=}\NormalTok{ theta[}\DecValTok{1}\NormalTok{]}
\NormalTok{    delta }\OtherTok{=} \FunctionTok{exp}\NormalTok{(theta[}\DecValTok{2}\NormalTok{]) }\CommentTok{\#note the transformation}
    \DocumentationTok{\#\#AJW\#\# there are three parameters}
\NormalTok{    alpha }\OtherTok{=} \FunctionTok{exp}\NormalTok{(theta[}\DecValTok{3}\NormalTok{])}
    \CommentTok{\#sum(dlogisIII(y,location=mu,scale=delta,log=TRUE))}
    \FunctionTok{sum}\NormalTok{(}\FunctionTok{dlogisIII}\NormalTok{(y,}\AttributeTok{location=}\NormalTok{mu,}\AttributeTok{scale=}\NormalTok{delta,}\AttributeTok{shape=}\NormalTok{alpha,}\AttributeTok{log=}\ConstantTok{TRUE}\NormalTok{))}
\NormalTok{  \}}
  \CommentTok{\#using optim {-} starting at a guess of mu=0 and log(delta)=0 {-}{-} par=c(0,0)}
  \DocumentationTok{\#\#AJW\#\# 3 dimensional optimization, need 3 dimensional starting point}
  \CommentTok{\#opt\_out = optim(par=c(0,0),f,control=list(fnscale={-}1,maxit=1000,reltol=1e{-}8))}
\NormalTok{  opt\_out }\OtherTok{=} \FunctionTok{optim}\NormalTok{(}\AttributeTok{par=}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{),f,}\AttributeTok{control=}\FunctionTok{list}\NormalTok{(}\AttributeTok{fnscale=}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{,}\AttributeTok{maxit=}\DecValTok{1000}\NormalTok{,}\AttributeTok{reltol=}\FloatTok{1e{-}8}\NormalTok{))}
\NormalTok{  par }\OtherTok{=}\NormalTok{ opt\_out}\SpecialCharTok{$}\NormalTok{par}
\NormalTok{  par[}\DecValTok{2}\NormalTok{] }\OtherTok{=} \FunctionTok{exp}\NormalTok{(par[}\DecValTok{2}\NormalTok{]) }\CommentTok{\#transforming to delta}
  \DocumentationTok{\#\#AJW\#\# geting alpha out and adding name to names}
\NormalTok{  par[}\DecValTok{3}\NormalTok{] }\OtherTok{=} \FunctionTok{exp}\NormalTok{(par[}\DecValTok{3}\NormalTok{])}
  \CommentTok{\#names(par) = c("mu","delta") \#NAMES ARE GOOD}
  \FunctionTok{names}\NormalTok{(par) }\OtherTok{=} \FunctionTok{c}\NormalTok{(}\StringTok{"mu"}\NormalTok{,}\StringTok{"delta"}\NormalTok{,}\StringTok{"alpha"}\NormalTok{) }\CommentTok{\#NAMES ARE GOOD}
\NormalTok{  out }\OtherTok{=} \FunctionTok{list}\NormalTok{(}\AttributeTok{theta=}\NormalTok{par,}\AttributeTok{loglik=}\NormalTok{opt\_out}\SpecialCharTok{$}\NormalTok{value)}
  \FunctionTok{return}\NormalTok{(out)}
\NormalTok{\}}

\DocumentationTok{\#\#AJW\#\# need to make a funciton for logistic type III,}
\DocumentationTok{\#\# it should use the helper functions below and be a modification of this function}
\DocumentationTok{\#\# to do the 3 parameter optimization}
\end{Highlighting}
\end{Shaded}

\begin{enumerate}
\def\labelenumi{\alph{enumi})}
\setcounter{enumi}{1}
\tightlist
\item
  Compute the mle\_logis(y=log(melanoma\$thickness)) Plot density of the
  model using dlogisIII with KDE of y Does the model appear to capture
  the data well?
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{mle\_logisIII}\NormalTok{(y)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## $theta
##        mu     delta     alpha 
## 0.6242548 2.0660958 8.8629934 
## 
## $loglik
## [1] -292.7986
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{fit\_logisIII\_y }\OtherTok{=} \FunctionTok{mle\_logisIII}\NormalTok{(y)}

\FunctionTok{plot}\NormalTok{(}\FunctionTok{density}\NormalTok{(y),}\AttributeTok{xlim=}\FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{3}\NormalTok{,}\DecValTok{4}\NormalTok{),}\AttributeTok{ylim=}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\FloatTok{0.45}\NormalTok{))}

\DocumentationTok{\#\#AJW\#\# some changes here}
\DocumentationTok{\#\#I am going to comment your line and do what the line would be for the for}
\DocumentationTok{\#\#to the logistic distribution (shape parameter alpha=1)}
\CommentTok{\#lines(dlogisIII(y,fit\_logis\_y[["theta"]][["mu"]],fit\_logis\_y[["theta"]][["delta"]],1))}
\NormalTok{x\_val }\OtherTok{=} \FunctionTok{seq}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{3}\NormalTok{,}\DecValTok{4}\NormalTok{,}\AttributeTok{length.out=}\DecValTok{1000}\NormalTok{)}
\DocumentationTok{\#\#AJW\#\# there are 3 parameters}
\CommentTok{\#dens\_logisIII\_vals = dlogisIII(x\_val,fit\_logisIII\_y[["theta"]][["mu"]],fit\_logisIII\_y[["theta"]][["delta"]])}
\NormalTok{dens\_logisIII\_vals }\OtherTok{=} \FunctionTok{dlogisIII}\NormalTok{(x\_val,fit\_logisIII\_y[[}\StringTok{"theta"}\NormalTok{]][}\StringTok{"mu"}\NormalTok{],fit\_logisIII\_y[[}\StringTok{"theta"}\NormalTok{]][}\StringTok{"delta"}\NormalTok{],fit\_logisIII\_y[[}\StringTok{"theta"}\NormalTok{]][}\StringTok{"alpha"}\NormalTok{])}
\FunctionTok{lines}\NormalTok{(dens\_logisIII\_vals}\SpecialCharTok{\textasciitilde{}}\NormalTok{x\_val,}\AttributeTok{col=}\StringTok{"blue"}\NormalTok{,}\AttributeTok{lty=}\DecValTok{2}\NormalTok{)}
\FunctionTok{legend}\NormalTok{(}\StringTok{"bottom"}\NormalTok{,}\AttributeTok{legend=}\FunctionTok{c}\NormalTok{(}\StringTok{"KDE"}\NormalTok{,}\StringTok{"Fitted"}\NormalTok{),}\AttributeTok{col=}\FunctionTok{c}\NormalTok{(}\StringTok{"black"}\NormalTok{,}\StringTok{"blue"}\NormalTok{),}\AttributeTok{lty=}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{),}\AttributeTok{bty=}\StringTok{"n"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{hw3_fissel_files/figure-latex/unnamed-chunk-4-1.pdf}
The Model does a decent job at capturing the data. The middle of the
fitted graph is a bit taller than the KDE, however it smoothes the
curves of the KDE quite nicely.

\begin{enumerate}
\def\labelenumi{\alph{enumi})}
\setcounter{enumi}{2}
\tightlist
\item
  Do a goodness of fit test for the fitted Type III logisitic
  distribution using ks.test.
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\#AJW\#\#}
\DocumentationTok{\#\#because your fit from above is the the logistic and not logistic type 3, }
\DocumentationTok{\#\#I am going to rewrite this line to demonstrate comparison to logistic}
\DocumentationTok{\#\#your setting alpha=1 is doing that, but I think it will be cleaner to see this again}
\DocumentationTok{\#\#ks.test(y, dlogisIII, location = fit\_logis\_y[["theta"]][["mu"]], }
\DocumentationTok{\#\#        scale = fit\_logis\_y[["theta"]][["delta"]], shape = 1)}
\DocumentationTok{\#\# comparison is to a probability function and not a density function}
\DocumentationTok{\#\# so plogis instead of dlogis}
\DocumentationTok{\#\#AJW\#\# logistic III, so need all 3 parameters}
\CommentTok{\#ks.test(y, plogisIII, location = fit\_logisIII\_y[["theta"]][["mu"]], }
\CommentTok{\#        scale = fit\_logisIII\_y[["theta"]][["delta"]])}
\FunctionTok{ks.test}\NormalTok{(y, plogisIII, }\AttributeTok{location =}\NormalTok{ fit\_logisIII\_y[[}\StringTok{"theta"}\NormalTok{]][}\StringTok{"mu"}\NormalTok{], }
        \AttributeTok{scale =}\NormalTok{ fit\_logisIII\_y[[}\StringTok{"theta"}\NormalTok{]][}\StringTok{"delta"}\NormalTok{],}
        \AttributeTok{shape =}\NormalTok{ fit\_logisIII\_y[[}\StringTok{"theta"}\NormalTok{]][}\StringTok{"alpha"}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning in ks.test(y, plogisIII, location = fit_logisIII_y[["theta"]]["mu"], :
## ties should not be present for the Kolmogorov-Smirnov test
\end{verbatim}

\begin{verbatim}
## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  y
## D = 0.057729, p-value = 0.5016
## alternative hypothesis: two-sided
\end{verbatim}

\begin{enumerate}
\def\labelenumi{\alph{enumi})}
\setcounter{enumi}{3}
\tightlist
\item
  Perform tasks b) and c) using the mle\_logis function that I provided
  and the built-in dlogis and plogis functions.
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mle\_logis }\OtherTok{=} \ControlFlowTok{function}\NormalTok{(y)\{}
  \CommentTok{\#function to optimize using optim}
\NormalTok{  f }\OtherTok{=} \ControlFlowTok{function}\NormalTok{(theta)\{}
\NormalTok{    mu }\OtherTok{=}\NormalTok{ theta[}\DecValTok{1}\NormalTok{]}
\NormalTok{    delta }\OtherTok{=} \FunctionTok{exp}\NormalTok{(theta[}\DecValTok{2}\NormalTok{]) }\CommentTok{\#note the transformation}
    \FunctionTok{sum}\NormalTok{(}\FunctionTok{dlogis}\NormalTok{(y,}\AttributeTok{location=}\NormalTok{mu,}\AttributeTok{scale=}\NormalTok{delta,}\AttributeTok{log=}\ConstantTok{TRUE}\NormalTok{))}
\NormalTok{  \}}
  \CommentTok{\#using optim {-} starting at a guess of mu=0 and log(delta)=0 {-}{-} par=c(0,0)}
\NormalTok{  opt\_out }\OtherTok{=} \FunctionTok{optim}\NormalTok{(}\AttributeTok{par=}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{),f,}\AttributeTok{control=}\FunctionTok{list}\NormalTok{(}\AttributeTok{fnscale=}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{,}\AttributeTok{maxit=}\DecValTok{1000}\NormalTok{,}\AttributeTok{reltol=}\FloatTok{1e{-}8}\NormalTok{))}
\NormalTok{  par }\OtherTok{=}\NormalTok{ opt\_out}\SpecialCharTok{$}\NormalTok{par}
\NormalTok{  par[}\DecValTok{2}\NormalTok{] }\OtherTok{=} \FunctionTok{exp}\NormalTok{(par[}\DecValTok{2}\NormalTok{]) }\CommentTok{\#transforming to delta}
  \FunctionTok{names}\NormalTok{(par) }\OtherTok{=} \FunctionTok{c}\NormalTok{(}\StringTok{"mu"}\NormalTok{,}\StringTok{"delta"}\NormalTok{) }\CommentTok{\#NAMES ARE GOOD}
\NormalTok{  out }\OtherTok{=} \FunctionTok{list}\NormalTok{(}\AttributeTok{theta=}\NormalTok{par,}\AttributeTok{loglik=}\NormalTok{opt\_out}\SpecialCharTok{$}\NormalTok{value)}
  \FunctionTok{return}\NormalTok{(out)}
\NormalTok{\}}
\FunctionTok{mle\_logis}\NormalTok{(y)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## $theta
##        mu     delta 
## 0.6486642 0.5729925 
## 
## $loglik
## [1] -293.9161
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{fit\_logis\_y }\OtherTok{=} \FunctionTok{mle\_logis}\NormalTok{(y)}

\NormalTok{dens\_y }\OtherTok{=} \FunctionTok{density}\NormalTok{(y)}
\NormalTok{x\_seq }\OtherTok{=}\NormalTok{ dens\_y}\SpecialCharTok{$}\NormalTok{x }\CommentTok{\#seq(lb, ub,length.out=whatever)}
\NormalTok{fitted\_dens\_y }\OtherTok{=} \FunctionTok{dlogis}\NormalTok{(x\_seq,fit\_logis\_y}\SpecialCharTok{$}\NormalTok{theta[}\StringTok{\textquotesingle{}mu\textquotesingle{}}\NormalTok{],fit\_logis\_y}\SpecialCharTok{$}\NormalTok{theta[}\StringTok{\textquotesingle{}delta\textquotesingle{}}\NormalTok{])}

\FunctionTok{plot}\NormalTok{(}\FunctionTok{density}\NormalTok{(y),}\AttributeTok{main=}\StringTok{\textquotesingle{}model fit plot\textquotesingle{}}\NormalTok{,}\AttributeTok{xlab=}\StringTok{\textquotesingle{}y\textquotesingle{}}\NormalTok{,}\AttributeTok{ylab=}\StringTok{\textquotesingle{}desity\textquotesingle{}}\NormalTok{,}\AttributeTok{ylim=}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\FunctionTok{max}\NormalTok{(}\FunctionTok{c}\NormalTok{(dens\_y}\SpecialCharTok{$}\NormalTok{y,fitted\_dens\_y))),}\AttributeTok{xlim=}\FunctionTok{range}\NormalTok{(x\_seq))}
\FunctionTok{lines}\NormalTok{(fitted\_dens\_y}\SpecialCharTok{\textasciitilde{}}\NormalTok{x\_seq,}\AttributeTok{lty=}\DecValTok{1}\NormalTok{,}\AttributeTok{col=}\StringTok{\textquotesingle{}purple\textquotesingle{}}\NormalTok{)}
\FunctionTok{legend}\NormalTok{(}\StringTok{"bottom"}\NormalTok{,}\AttributeTok{legend=}\FunctionTok{c}\NormalTok{(}\StringTok{"KDE"}\NormalTok{,}\StringTok{"Fitted"}\NormalTok{),}\AttributeTok{col=}\FunctionTok{c}\NormalTok{(}\StringTok{"black"}\NormalTok{,}\StringTok{"purple"}\NormalTok{),}\AttributeTok{lty=}\NormalTok{(}\DecValTok{1}\NormalTok{),}\AttributeTok{bty=}\StringTok{"n"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{hw3_fissel_files/figure-latex/unnamed-chunk-6-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\#\#}

\FunctionTok{ks.test}\NormalTok{(y, plogis, }\AttributeTok{location =}\NormalTok{ fit\_logis\_y[[}\StringTok{"theta"}\NormalTok{]][[}\StringTok{"mu"}\NormalTok{]], }
        \AttributeTok{scale =}\NormalTok{ fit\_logis\_y[[}\StringTok{"theta"}\NormalTok{]][[}\StringTok{"delta"}\NormalTok{]])}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning in ks.test(y, plogis, location = fit_logis_y[["theta"]][["mu"]], : ties
## should not be present for the Kolmogorov-Smirnov test
\end{verbatim}

\begin{verbatim}
## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  y
## D = 0.054211, p-value = 0.5833
## alternative hypothesis: two-sided
\end{verbatim}

I'd say the model does a decent job handling the data. The center is
taller, and has much smoother curve.

\begin{enumerate}
\def\labelenumi{\alph{enumi})}
\setcounter{enumi}{4}
\tightlist
\item
  Compare the log-likelihood evaluated at the MLE for the Logistic and
  Type III logistic models. Which model has higher log-likelihood? Which
  model is better at capturing the data? Do you think it was worth
  adding the shape parameter Î± to the Logistic distribution for modeling
  this dataset? The Logisitic had a slightly higher loglikelihood at the
  MLE than the Type III. I would say the Type III model is better at
  capturing the data. It more accurately mimics the shape of the KDE.
  This is likely because of the alpha parameter, allowing us to better
  capture the dataset. Absolutely worth adding the alpha, I think.
\end{enumerate}

\end{document}
