1:ncol(X)
x = X[,-i]
SSE = rep(0,ncol(X))
for (i in 1:ncol(X)) {
x = X[,-i]
y = dat[,2]
xbar = sum(x)/n
ybar = sum(y)/n
xybar = sum(x*y)/n
xsqbar = sum(x*x)/n
b = (ybar*xsqbar-xbar*xybar)/ (xsqbar - xbar*xbar)  # from our calculations
a = (ybar - b)/xbar
e = y - ybar
SSE[i] = sum(e*e)
}
SSE
SSE = rep(0,ncol(X))
for (i in 1:ncol(X)) {
x = X[,-i]
y = dat[,2]
xbar = sum(x)/n
ybar = sum(y)/n
xybar = sum(x*y)/n
xsqbar = sum(x*x)/n
b = (ybar*xsqbar-xbar*xybar)/ (xsqbar - xbar*xbar)  # from our calculations
a = (ybar - b)/xbar
yhat = X %*% a
e = y - yhat
SSE[i] = sum(e*e)
}
SSE = rep(0,ncol(X))
for (i in 1:ncol(X)) {
x = X[,-i]
y = dat[,2]
xbar = sum(x)/n
ybar = sum(y)/n
xybar = sum(x*y)/n
xsqbar = sum(x*x)/n
b = (ybar*xsqbar-xbar*xybar)/ (xsqbar - xbar*xbar)  # from our calculations
a = (ybar - b)/xbar
yhat = X %*% a
e = y - yhat
SSE[i] = sum(e*e)
}
SSE = rep(0,ncol(X))
for (i in 1:ncol(X)) {
x = X[,-i]
y = dat[,2]
xbar = sum(x)/n
ybar = sum(y)/n
xybar = sum(x*y)/n
xsqbar = sum(x*x)/n
b = (ybar*xsqbar-xbar*xybar)/ (xsqbar - xbar*xbar)  # from our calculations
a = (ybar - b)/xbar
e = y - ybar
SSE[i] = sum(e*e)
}
SSE
n = nrow(dat)
x = as.matrix(dat[,3:12])
y = dat[,2]
SSE <- numeric(ncol(x))
for (i in seq_len(ncol(x))) {
x_subset <- x[, -i]
xbar <- colMeans(x_subset)
ybar <- mean(y)
xybar <- colMeans(x_subset * y)
xsqbar <- colMeans(x_subset^2)
b <- (ybar * xsqbar - xbar * xybar) / (xsqbar - xbar^2)
a <- ybar - b * xbar
e <- y - (a + x_subset %*% b)
SSE[i] <- sum(e^2)
}
cat('SSE:', SSE)
n = nrow(dat);
x = as.matrix(dat[,3:12])
y = dat[,2]
xbar = sum(x)/n;
ybar = sum(y)/n;
xybar = sum(x*y)/n
xsqbar = sum(x*x)/n
b = (ybar*xsqbar-xbar*xybar)/ (xsqbar - xbar*xbar)  # from our calculations
a = (ybar - b)/xbar
e = y - ybar
SSE = sum(e*e)
cat('yhat = ', ybar, '\n', 'SSE = ', SSE)
SSE = rep(0,ncol(X))
for (i in 1:ncol(X)) {
x = X[,-i]
y = dat[,2]
xbar = sum(x)/n
ybar = sum(y)/n
xybar = sum(x*y)/n
xsqbar = sum(x*x)/n
b = (ybar*xsqbar-xbar*xybar)/ (xsqbar - xbar*xbar)  # from our calculations
a = (ybar - b)/xbar
e = y - ybar
SSE[i] = sum(e*e)
}
SSE
SSE = rep(0,ncol(X))
for (i in 1:ncol(X)) {
x = X[,-i]
y = dat[,2]
xbar = sum(x)/n
ybar = sum(y)/n
xybar = sum(x*y)/n
xsqbar = sum(x*x)/n
b = (ybar*xsqbar-xbar*xybar)/ (xsqbar - xbar*xbar)  # from our calculations
a = (ybar - b)/xbar
yhat = (a %*% x ) + b
e = y - hat
SSE[i] = sum(e*e)
}
SSE = rep(0,ncol(X))
for (i in 1:ncol(X)) {
x = X[,-i]
y = dat[,2]
xbar = sum(x)/n
ybar = sum(y)/n
xybar = sum(x*y)/n
xsqbar = sum(x*x)/n
b = (ybar*xsqbar-xbar*xybar)/ (xsqbar - xbar*xbar)  # from our calculations
a = (ybar - b)/xbar
yhat = (a %*% x ) + b
e = y - yhat
SSE[i] = sum(e*e)
}
x = X[,-i]
y = dat[,2]
xbar = sum(x)/n
ybar = sum(y)/n
xybar = sum(x*y)/n
xsqbar = sum(x*x)/n
a = (ybar - b)/xbar
yhat = (a %*% x) + b
SSE = rep(0,ncol(X))
for (i in 1:ncol(X)) {
x = X[,-i]
y = dat[,2]
xbar = sum(x)/n
ybar = sum(y)/n
xybar = sum(x*y)/n
xsqbar = sum(x*x)/n
b = (ybar*xsqbar-xbar*xybar)/ (xsqbar - xbar*xbar)  # from our calculations
a = (ybar - b)/xbar
yhat = (a * x) + b
e = y - yhat
SSE[i] = sum(e*e)
}
SSE
data(nottem)
y = nottem
n = length(y)
x = 1:n;
plot(x,y,type="b") # b is for "both"
X = matrix(x)
X = matrix(x,rep(1,n))
View(X)
X = matrix(x)
View(X)
X = cbind(x,rep(1,n))
View(X)
data(nottem)
y = nottem
n = length(y)
x = 1:n;
plot(x,y,type="b") # b is for "both"
X = cbind(x,rep(1,n))
y = nottem
#a = solve(t(X) %*% X, t(X) %*% y)
x = X
xbar = sum(x)/n
ybar = sum(y)/n
xybar = sum(x*y)/n
n = length(y)
plot(x,y,type="b") # b is for "both"
X = cbind(x,rep(1,n))
y = nottem
#a = solve(t(X) %*% X, t(X) %*% y)
x = X
xbar = sum(x)/n
ybar = sum(y)/n
xybar = sum(x*y)/n
X = cbind(x,rep(1,n))
y = nottem
a = solve(t(X) %*% X, t(X) %*% y)
y = nottem
X = cbind(x,rep(1,n))
y = nottem
x = X
xbar = sum(x)/n
ybar = sum(y)/n
xybar = sum(x*y)/n
X = cbind(x,rep(1,n))
y = nottem
x = X
xbar = sum(x)/n
ybar = sum(y)/n
xybar = sum(x%*%y)/n
X = cbind(x,rep(1,n))
y = nottem
x = X
xbar = sum(x)/n
ybar = sum(y)/n
xybar = sum(t(x)%*%y)/n
xsqbar = sum(x*x)/n
b = (ybar*xsqbar-xbar*xybar)/ (xsqbar - xbar*xbar)  # from our calculations
a = (ybar - b)/xbar
abline(b,a)			# add the line that fits the data
X = cbind(x,rep(1,n))
y = nottem
x = X
ybar = sum(y)/n
xybar = sum(t(x)%*%y)/n
xsqbar = sum(x*x)/n
b = (ybar*xsqbar-xbar*xybar)/ (xsqbar - xbar*xbar)  # from our calculations
a = (ybar - b)/xbar
abline(b,a)			# add the line that fits the data
plot(x,y,type="b")
plot(x,y,type="b")
data(nottem)
y = nottem
n = length(y)
x = 1:n;
plot(x,y,type="b") # b is for "both"
plot(x,y,type="b")
X = cbind(x,rep(1,n))
y = nottem
x = X
xbar = sum(x)/n
ybar = sum(y)/n
xybar = sum(t(x)%*%y)/n
xsqbar = sum(x*x)/n
b = (ybar*xsqbar-xbar*xybar)/ (xsqbar - xbar*xbar)  # from our calculations
a = (ybar - b)/xbar
abline(b,a)			# add the line that fits the data
# abline plots line with slope b and y intercept a
X = cbind(rep(1,n),x,x^2,cos(2*pi*x/12),sin(2*pi*x/12))
View(X)
X = cbind(rep(1,n),x,x^2,cos(2*pi*x/12),sin(2*pi*x/12))
a = solve(t(X) %*% X, t(X) %*% y)
X = cbind(rep(1,n),x,x^2,cos(2*pi*x/12),sin(2*pi*x/12))
a = solve(t(X) %*% X, t(X) %*% y)
X = cbind(rep(1,n),x,cos(2*pi*x/12),sin(2*pi*x/12))
a = solve(t(X) %*% X, t(X) %*% y)
yhat = X %*% a
lines(x,yhat,col=2)
data(nottem)
y = nottem
n = length(y)
x = 1:n;
plot(x,y,type="b") # b is for "both"
plot(x,y,type="b")
X = cbind(x,rep(1,n))
y = nottem
x = X
xbar = sum(x)/n
ybar = sum(y)/n
xybar = sum(t(x)%*%y)/n
xsqbar = sum(x*x)/n
b = (ybar*xsqbar-xbar*xybar)/ (xsqbar - xbar*xbar)  # from our calculations
a = (ybar - b)/xbar
abline(b,a)			# add the line that fits the data
# abline plots line with slope b and y intercept a
X = cbind(rep(1,n),x,cos(2*pi*x/12),sin(2*pi*x/12))
a = solve(t(X) %*% X, t(X) %*% y)
View(X)
x = 1:n;
X = cbind(rep(1,n),x,cos(2*pi*x/12),sin(2*pi*x/12))
a = solve(t(X) %*% X, t(X) %*% y)
yhat = X %*% a
lines(x,yhat,col=2)
data(nottem)
y = nottem
n = length(y)
x = 1:n;
plot(x,y,type="b") # b is for "both"
X = cbind(rep(1,n),x,cos(2*pi*x/12),sin(2*pi*x/12))
a = solve(t(X) %*% X, t(X) %*% y)
yhat = X %*% a
lines(x,yhat,col=2)
data(nottem)
y = nottem
n = length(y)
x = 1:n;
plot(x,y,type="b") # b is for "both"
plot(x,y,type="b")
X = cbind(x,rep(1,n))
y = nottem
x = X
xbar = sum(x)/n
ybar = sum(y)/n
xybar = sum(t(x)%*%y)/n
xsqbar = sum(x*x)/n
b = (ybar*xsqbar-xbar*xybar)/ (xsqbar - xbar*xbar)  # from our calculations
a = (ybar - b)/xbar
abline(b,a)			# add the line that fits the data
# abline plots line with slope b and y intercept a
data(nottem)
y = nottem
n = length(y)
x = 1:n;
plot(x,y,type="b") # b is for "both"
X = cbind(rep(1,n),x,cos(2*pi*x/12),sin(2*pi*x/12))
a = solve(t(X) %*% X, t(X) %*% y)
yhat = X %*% a
lines(x,yhat,col=c(1,2,3))
data(nottem)
y = nottem
n = length(y)
x = 1:n;
plot(x,y,type="b") # b is for "both"
X = cbind(rep(1,n),x,cos(2*pi*x/12),sin(2*pi*x/12))
a = solve(t(X) %*% X, t(X) %*% y)
yhat = X %*% a
lines(x,yhat,col=c(2,3))
lines(x,a,col=3)
data(nottem)
y = nottem
n = length(y)
x = 1:n;
plot(x,y,type="b") # b is for "both"
X = cbind(rep(1,n),x,cos(2*pi*x/12),sin(2*pi*x/12))
a = solve(t(X) %*% X, t(X) %*% y)
yhat = X %*% a
lines(x,yhat,col=2)
data = data(AirPassengers)
data
data(AirPassengers)
y = AirPassengers
n = length(y)
x = 1:n
plot(x,log(y))
a = solve(t(X) %*% X, t(X) %*% y)
data(AirPassengers)
y = AirPassengers
n = length(y)
x = 1:n
plot(x,log(y))
X = cbind(rep(1,n),x)
a = solve(t(X) %*% X, t(X) %*% y)
yhat = X %*% a
data(AirPassengers)
y = AirPassengers
n = length(y)
x = 1:n
plot(x,log(y))
X = cbind(rep(1,n),x)
a = solve(t(X) %*% X, t(X) %*% y)
yhat = X %*% a
lines(x,yhat,col=4)
lines(x,yhat,col=4)
data(AirPassengers)
y = AirPassengers
n = length(y)
x = 1:n
plot(x,log(y))
a = solve(t(X) %*% X, t(X) %*% y)
lines(x,yhat,col=4)
data(AirPassengers)
y = AirPassengers
n = length(y)
x = 1:n
plot(x,log(y))
X = cbind(rep(1,n),x)
a = solve(t(X) %*% X, t(X) %*% y)
yhat = X %*% a
lines(x,yhat,col=4)
data(AirPassengers)
y = AirPassengers
n = length(y)
x = 1:n
plot(x,log(y))
X = cbind(rep(1,n),x)
a = solve(t(X) %*% X, t(X) %*% y)
yhat = X %*% a
lines(x,log(yhat),col=4)
data(AirPassengers)
y = AirPassengers
n = length(y)
x = 1:n
plot(x,log(y))
X = cbind(rep(1,n),x)
a = solve(t(X) %*% X, t(X) %*% y)
yhat = X %*% a
lines(x,log(yhat),col='purple')
plot(x,yhat)
plot(x,y)
plot(x,y)
lines(x,yhat,col='purple')
data(nottem)
y = nottem
n = length(y)
x = 1:n;
plot(x,y,type="b") # b is for "both"
X = cbind(rep(1,n),x,cos(2*pi*x/12),sin(2*pi*x/12),x)
a = solve(t(X) %*% X, t(X) %*% y)
vocab = read.csv('Desktop/b365/Vocab.csv')
#plot(vocab)
n = nrow(vocab)
x = vocab$education
y = vocab$vocabulary
X = cbind(x,rep(1,n))
xbar = sum(x)/n;
ybar = sum(y)/n;
xybar = sum(x*y)/n
xsqbar = sum(x*x)/n
b = (ybar*xsqbar-xbar*xybar)/ (xsqbar - xbar*xbar)  # from our calculations
a = (ybar - b)/xbar
cat("a and b are ", a, b, "\n");
plot(x,y)
abline(a,b)
X = matrix(c(1,-1,2,5,4,0,1,1,1),byrow=F,nrow=3)
y = c(3,2,1)
x = c(1,2,3)
a = solve(X, y)
print(a)
X = matrix(c(1,-1,2,5,4,0),byrow=F,nrow=3)
y = c(3,2,1)
a = solve(t(X) %*% X,t(X) %*% y)
print(c(a))
X = matrix(c(.2,0,0,.3,.4,0,.4,0,.2,.1,.2,.3,.1,.3,.4,0,.1,.3,0,.3,0,.3,0,.1),byrow = T,nrow=6)
y = c(20,20,20,20,20,20)
a = solve(t(X) %*% X,t(X) %*% y)
yhat = X %*% a
e = y - yhat
SSE = sum(e*e)
cat('SSE = ' ,SSE)
SSE = rep(0,1000)
for (i in 1:1000){
X = matrix(c(.2,0,0,.3,.4,0,.4,0,.2,.1,.2,.3,.1,.3,.4,0,.1,.3,0,.3,0,.3,0,.1),byrow = T,nrow=6)
y = c(20,20,20,20,20,20)
y = y + (.1*rnorm(4))
a = solve(t(X) %*% X,t(X) %*% y)
yhat = X %*% a
e = y - yhat
SSE[i] = sum(e*e)
#cat('SSE = ' ,SSE)
}
min(SSE)
X = matrix(c(.2,0,0,.3,.4,0,.4,0,.2,.1,.2,.3,.1,.3,.4,0),byrow = F,nrow=4)
y = c(20,20,20,20)
a = solve(X,y)
yhat = X %*% a
cat('a = ',a,'\n','yhat = ',yhat)
dat = read.csv("Desktop/b365/ais.csv",stringsAsFactors=FALSE, sep=",")
X = as.matrix(dat[,3:12])
y = dat[,2]
a = solve(t(X) %*% X,t(X) %*% y)
cat('Regression Coeff: ',a)
n = nrow(dat);
x = as.matrix(dat[,3:12])
y = dat[,2]
xbar = sum(x)/n;
ybar = sum(y)/n;
xybar = sum(x*y)/n
xsqbar = sum(x*x)/n
b = (ybar*xsqbar-xbar*xybar)/ (xsqbar - xbar*xbar)  # from our calculations
a = (ybar - b)/xbar
e = y - ybar
SSE = sum(e*e)
cat('yhat = ', ybar, '\n', 'SSE = ', SSE)
SSE = rep(0,ncol(X))
for (i in 1:ncol(X)) {
x = X[,-i]
y = dat[,2]
xbar = sum(x)/n
ybar = sum(y)/n
xybar = sum(x*y)/n
xsqbar = sum(x*x)/n
b = (ybar*xsqbar-xbar*xybar)/ (xsqbar - xbar*xbar)  # from our calculations
a = (ybar - b)/xbar
yhat = (a * x) + b
e = y - yhat
SSE[i] = sum(e*e)
}
SSE
data(nottem)
y = nottem
n = length(y)
x = 1:n;
plot(x,y,type="b") # b is for "both"
plot(x,y,type="b")
X = cbind(x,rep(1,n))
y = nottem
x = X
xbar = sum(x)/n
ybar = sum(y)/n
xybar = sum(t(x)%*%y)/n
xsqbar = sum(x*x)/n
b = (ybar*xsqbar-xbar*xybar)/ (xsqbar - xbar*xbar)  # from our calculations
a = (ybar - b)/xbar
abline(b,a)			# add the line that fits the data
# abline plots line with slope b and y intercept a
data(nottem)
y = nottem
n = length(y)
x = 1:n;
plot(x,y,type="b") # b is for "both"
X = cbind(rep(1,n),x,cos(2*pi*x/12),sin(2*pi*x/12))
a = solve(t(X) %*% X, t(X) %*% y)
yhat = X %*% a
lines(x,yhat,col=2)
data(nottem)
y = nottem
n = length(y)
x = 1:n;
plot(x,y,type="b") # b is for "both"
X = cbind(rep(1,n),x,cos(2*pi*x/12),sin(2*pi*x/12),x)
a = solve(t(X) %*% X, t(X) %*% y)
unlink("~/hw_6_b365_fissel_cache", recursive = TRUE)
